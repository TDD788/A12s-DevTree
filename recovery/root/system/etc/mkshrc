#!/bin/bash

# Minimal /system/etc/mkshrc for Android

# Default HOSTNAME if not provided by system
: ${HOSTNAME:=$(getprop ro.product.device)}
: ${HOSTNAME:=android}
export HOSTNAME

# HOME
export HOME=/sdcard/Fox
[ ! -d $HOME ] && mkdir -p $HOME
[ ! -d $HOME ] && export HOME=/sdcard

# shell
export HISTFILE=$HOME/.sh_history
export PS1='\s-\v \w > '

# Default TMPDIR
: ${TMPDIR:=/tmp}
export TMPDIR

InitFox() {
    alias dir="ls -all --color=auto"
    alias la='ls -a'
    alias ll='ls -a -l'
    alias lo='ls -a -l'
    alias l='find "$@" -maxdepth 1 -exec ls --color=auto -lh {} +'
    alias grep='grep -n --color=auto'
    alias fgrep='fgrep -n --color=auto'
    alias egrep='egrep -n --color=auto'
    alias python=python3
    alias python3=python_cli
    alias nano='nano --term pcansi "$@"'
    alias cls="clear"
	alias seek='find . -type d -path ./proc -prune -o -name "$@"'
	alias dirp="ls -all --color=auto -t | more"
	alias dirt="ls -all --color=auto -t"
	alias dirs="ls -all --color=auto -S"
	alias rd="rmdir"
	alias md="mkdir"
	alias del="rm -i"
	alias ren="mv -i"
	alias copy="cp -i"
	alias q="exit"
	alias diskfree="df -Ph"
	alias path="echo $PATH"
	alias mem="cat /proc/meminfo && free"
	alias ver="cat /proc/version"
	alias makediff="diff -u -d -w -B"
	alias makediff_recurse="diff -U3 -d -w -rN"

    if [ -f /sdcard/Fox/fox.mkshrc ]; then
       source /sdcard/Fox/fox.mkshrc
    elif [ -f /sdcard/Fox/fox.bashrc ]; then
       source /sdcard/Fox/fox.bashrc
    elif [ -f $HOME/.mkshrc ]; then
       source $HOME/.mkshrc;
    elif [ -f /sdcard/.mkshrc ]; then
       source /sdcard/.mkshrc;
    elif [ -f /FFiles/.mkshrc ]; then
       source /FFiles/.mkshrc;
    elif [ -f /data/recovery/.mkshrc ]; then
       source /data/recovery/.mkshrc;
    elif [ -f /sdcard1/.mkshrc ]; then
       source /sdcard1/.mkshrc;
    fi
    
    [ -z "$HOME" ] && export HOME=/sdcard
    [ -z "$SHELL" ] && export SHELL=/sbin/sh
    [ -z "$LINES" ] && export LINES=34
    [ -z "$COLUMNS" ] && export COLUMNS=63
    [ -z "$TERM" ] && export TERM=pcansi
    [ -z "$SHELL" ] && export SHELL=sh
    [ -z "$IS_ORANGEFOX_USER_TERM" ] && export IS_ORANGEFOX_USER_TERM=true
    
    filcome, Enjoy this Recovery."
	echo "           <3"
    
    red=$'\x1b[01;31m'
    green=$'\x1b[01;32m'
    blue=$'\x1b[01;34m'
    purple='\[\e[35m\]'
    NC=$'\x1b[0m'
    
    if (( USER_ID )); then
   	 PS1='$'
	else
    	PS1='#'
	fi
	export PS4='[$EPOCHREALTIME] '
	local e=$?
    local new_ps1=''
    (( e )) && new_ps1+="${red}${e}${NC}|"

    new_ps1+="(${green}${HOSTNAME}${NC}:${blue}\${PWD}${NC}"
    if [ -n "$VIRTUAL_ENV" ]; then
        new_ps1+="${purple} (venv:$(basename $VIRTUAL_ENV))${NC}"
    fi

    new_ps1+=")$> "
    PS1="$new_ps1"
    return $e
}

InitFox

$SHELL